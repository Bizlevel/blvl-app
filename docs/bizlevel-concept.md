## Концепция BizLevel (обновлённая, детализированная)

### Миссия
Помогаем предпринимателям расти через поэтапное обучение и практику: короткие уровни с видео, «чат‑тестом» для закрепления, персональные советы от ИИ‑тренеров и система целей с 28‑дневными спринтами.

### Ключевые столпы продукта
- **Путь по уровням**: последовательные уровни (в релизе 0–10), каждый из 3–5 коротких уроков (видео → чат‑тест) → артефакт.
- **Личные тренеры (База тренеров)**: два бота — Лео (бизнес‑ментор) и Макс (трекер цели). Чаты хранятся, есть поиск контекста (RAG), память, свёртки тем.
- **Цель и спринты**: пошаговая кристаллизация цели (v1→v4) и 28‑дневный трекинг с еженедельными чек‑инами и напоминаниями.
- **Навыки и прогресс**: 5 базовых навыков, за завершение уровней начисляются очки. Профиль показывает дерево навыков и доступные артефакты.
- **Мобильный first + кроссплатформа**: iOS/Android/Web/desktop, адаптивная сетка, стабильное видео и офлайн‑кеш данных.

---

## Пользовательский путь

### 0. Первый шаг (уровень 0 на Карте уровней)
- Экран‑уровень вместо онбординга: Intro → короткое видео → форма профиля (имя, аватар, цель, о себе) → финал.
- После сохранения профиля и просмотра видео — «Сохранить профиль».

#### Зачем это важно
- Профиль становится источником персонализации: Лео и Макс используют имя, цель, «о себе» и текущий уровень, чтобы давать конкретные советы, примеры и формулировки в ответах.

### 1. Карта уровней
- Список уровней с бейджами статуса: текущий, завершённый ✓, премиум ★.
- Первые 3 уровня — бесплатные; 4–10 открываются по подписке.
- Каждый уровень: 3–5 уроков + артефакт.

### 2. Уровни
- Видео 9:16 (Supabase Storage подписанные ссылки; ролики загружены в Vimeo), кэш и корректная работа на Web/iOS/Android.
- Блок «чат‑тест» вместо классического теста:
  - Визуально как чат: сверху «Лео», бейдж «Вопрос X.Y», сообщения от Лео и варианты ответа как правые «пузырьки» пользователя.
  - Выбор варианта подсвечивается, ответ Лео — короткий фидбек; лимиты чатов не тратятся.
  - Верный ответ разблокирует «Далее». Прогресс уровня учитывает просмотр видео и прохождение тестов.
- Артефакт уровня — описание + скачивание через подписанный URL.

#### Логика прохождения и связи с целью
- После завершения Уровня 1 вместо скачиваемого артефакта пользователь заполняет v1 «Семя цели». Это старт «личного проекта» на ближайшие 28 дней.
- Артефакты уровней 2–10 — скачиваемые бизнес‑тулкиты (шаблоны, чек‑листы, формулы), которые помогают применить знания.
- На ключевых уровнях происходит кристаллизация цели:
  - После Уровня 4 — v2 «Цифры и метрики» (добавляем измеримость и финансовую цель).
  - После Уровня 7 — v3 «SMART‑план» (план на 4 спринта по неделям).
  - После Уровня 10 — v4 «Финальная формула» (что/когда/как, готовность).
- Весь путь сопровождает Макс: напоминает о заполнении версий цели, помогает формулировать чётко и кратко, опираясь на материалы уровней.

### 3. База тренеров (вкладка вместо «Чат»)
- Заголовок по центру; две карточки:
  - **Leo AI** — твой бизнес‑ментор (стратегия, разбор уроков, практические рекомендации).
  - **Max AI** — твой помощник в достижении цели (кристаллизация целей, планирование спринтов, поддержка дисциплины).
- Список диалогов (постранично). Для каждого — название, дата.
- Новый чат с выбранным тренером (FAB). В истории хранятся только чаты, где уже были сообщения.
- Технологии и возможности:
  - Персонализация: берём профиль, текущий уровень/урок, знания (RAG), «память» пользователя и свёртки прошлых диалогов.
  - Безопасность: структурированные логи без PII; лимиты сообщений на тарифах.

#### Роли тренеров и их задачи

**Лео — бизнес‑ментор**
- **Роль**: наставник по бизнесу и контент‑владелец уровней. Помогает понять материал уроков и тут же применить его к ситуации пользователя.
- **Характер**: дружелюбный, уверенный, прагматичный. Говорит просто, по делу, без «воды», подкрепляет тезисы ссылкой на практики и бизнес‑литературу (персонализированно).
- **Где помогает**:
  - Разбор уроков и «перевод» теории на язык действий («что сделать завтра утром»).
  - Персональные примеры и мини‑кейсы «под нишу» пользователя (с опорой на профиль и историю диалогов).
  - Применение артефактов: как заполнить таблицу P&L, как собрать УТП, как выстроить питч — с шагами и шаблонами.
  - Рекомендации из бизнес‑классики (Питер Друкер, Котлер, ГКР и др.) — только релевантные фрагменты, адаптированные к контексту.
- **Типичные запросы**: «как применить артефакт из уровня X в моей булочной», «помоги переформулировать УТП для мам‑предпринимательниц», «чем заняться в первую неделю».
- **Границы**: не даёт юридических/налоговых советов как юрист/бухгалтер; вместо этого — чек‑листы и общие стандарты + рекомендация консультироваться со специалистом.

**Макс — трекер цели**
- **Роль**: партнёр по дисциплине и фокусировке. Помогает формулировать цель (v1→v4), планировать 28‑дневный путь и поддерживать ритм.
- **Характер**: мотиватор, поддерживающий и требовательный, держит фокус на результате и конкретных шагах текущей недели.
- **Где помогает**:
  - Кристаллизация цели: задаёт уточняющие вопросы, переводит размытую формулировку в чёткую и измеримую.
  - План недели/спринта: предлагает 2–3 конкретных шага и критерии успеха, отслеживает выполнение.
  - Рефлексия: помогает осмыслить итоги недели, связать прогресс с метрикой и выбрать артефакты для следующего шага.
  - Напоминания и настроение: краткие сообщения‑поддержки, когда темп падает.
- **Типичные запросы**: «сформулируй v2 для моей цели», «что сделать на этой неделе, чтобы продвинуться на +10%», «какой артефакт применить сейчас», «проверь мой SMART‑план».
- **Границы**: не заменяет руководителя/коуча; не навязывает «универсальный» план — всегда опирается на данные профиля, версии цели и прогресса.

### 4. Цель (страница «Цель»)
- Блок «Мотивация от Макса»: цитата дня из `motivational_quotes`, ежедневная ротация (детерминирована по UTC‑дню, авто‑обновление без перезапуска).
- Кристаллизация цели (версии):
  - v1 — «Семя цели»: что хочу за 28 дней; «почему сейчас»; главное препятствие. Заполняется как Артефакт уровня 1.
  - v2 — «Цифры и метрики»: конкретная цель, ключевая метрика, базовое/целевое значения, финансовая цель.
  - v3 — «SMART‑план»: SMART‑формулировка + цели спринтов 1–4.
  - v4 — «Финальная формула»: что/когда/как + подтверждение готовности.
  - Редактируется только текущая версия; предыдущие — read‑only. Автосохранение с дебаунсом (убрать).
- Путь к цели (28 дней) — после v4:
  - 4 спринта по 7 дней, напоминания, вертикальная timeline, ежедневный прогресс.
  - Еженедельный чек‑ин: короткая форма; после сохранения автоматически открывается диалог с Максом (трекинг‑режим).
  - В конце каждой недели пользователь отмечает: какие артефакты применил, промежуточные результаты по метрике, главный инсайт. После 4‑го спринта — финальные результаты и сравнение с целевыми показателями.

### 5. Профиль
- Аватар, имя, статус тарифа, краткая информация и цель.
- Дерево навыков: 5 прогресс‑бари с очками; +1 очко за завершённый уровень по привязанному навыку.
- Артефакты из пройденных уровней со скачиванием.

---

## Сервисная логика и архитектура

### Данные и бэкенд
- Supabase (Auth, PostgREST, Storage, Edge Functions). Все таблицы под RLS.
- Основные таблицы: `levels`, `lessons`, `user_progress`, `skills`, `user_skills`, `leo_chats`, `leo_messages`, `core_goals`, `weekly_progress`, `reminder_checks`, `motivational_quotes`, `documents` (для RAG).
- Ключевые функции/триггеры:
  - `update_current_level(level_id)` — завершение уровня, обновление текущего и начисление очков навыка (UPSERT `user_skills`).
  - Триггер памяти: после ассистентского сообщения запускается `leo-memory` (извлечение фактов/свёрток).

### ИИ‑функции
- `leo-chat` — единая точка: режимы ботов Лео/Макс, RAG (по документам и уровню/скиллу), персонализация (профиль/цели/спринты/память/свёртки), режим `mode='quiz'` для чат‑теста.
- `leo-memory` — извлекает факты из диалогов, записывает «память» и обновляет свёртки чатов.

### Клиент (Flutter)
- Навигация GoRouter: вкладки `/home` (Карта уровней), `/chat` (База тренеров), `/goal`, `/profile`.
- Riverpod + репозитории с Hive SWR‑кешем (офлайн‑чтение уровней/уроков/целей/цитат).
- Видео: кроссплатформенные контроллеры и фолбэки; корректные пропорции и плавная загрузка.
- Наблюдаемость: Sentry SDK, устойчивость к офлайн/таймаутам (единые retry‑хелперы), без логирования PII.

### Тарифы и доступ
- Бесплатно: уровни 0–3, ограниченный лимит сообщений с тренерами (общий лимит).
- Premium: все уровни, артефакты, приоритетный доступ, увеличенные лимиты чатов.

---

## UX‑принципы
- Сессии обучения короткие, скролл вертикальный, без перегрузки экрана.
- Чат‑тест стилистически совпадает с диалогом: формируем привычку общаться с тренером.
- «База тренеров» — нейтральные карточки выбора бота, единые размеры, выровненный текст и безопасный верхний отступ на мобильных.
- На десктопе — NavigationRail с подписями; на мобайле — лаконичная нижняя панель.

---

## Учебная методика
1. **PBS (problem‑based solving)**: обучаем решению реальных бизнес‑проблем, а не абстрактной теории. Каждый уровень закрывает конкретную задачу предпринимателя.
2. **Чат‑тесты для активации внимания**: через 1–2 минуты ролика пользователь вовлекается в мини‑диалог; это повышает концентрацию и вероятность запоминания за счёт необходимости выбора и рефлексии.
3. **Микролёрнинг**: короткие уроки «на ходу», близкие по формату к привычному потреблению контента. Это снижает порог входа и помогает не откладывать обучение.
4. **Геймификация и трекинг прогресса**: дерево навыков и последовательность уровней дают видимый прогресс и мотивируют продолжать.

---

## Артефакты (уровни 2–10)
- Бизнес‑тулкиты для самостоятельного применения: шаблоны учёта, чек‑листы, фреймворки УТП/питча, карты действий, юридические чек‑листы и др. Доступны для скачивания после прохождения соответствующих уровней.

---

## Каталог первых 10 уровней и связь с навыками
> Номера и названия — рабочие; каждый уровень привязан к одному из 5 базовых навыков.

1. **Уровень 1: Стартовый рывок — осознание целей** (Навык: 🧠 Фокус лидера)
   - Суть: сформировать личную цель и «линию горизонта». В конце — v1 «Семя цели».
2. **Уровень 2: Экспресс‑стресс‑менеджмент** (Навык: 🧠 Фокус лидера)
   - Суть: базовые техники восстановления и устойчивости; артефакт — чек‑лист практик.
3. **Уровень 3: Управление приоритетами (Эйзенхауэр)** (Навык: 🧠 Фокус лидера)
   - Суть: матрица срочно/важно, недельное планирование; артефакт — шаблон спринт‑плана.
4. **Уровень 4: Базовый учёт доходов/расходов** (Навык: 💰 Денежный контроль)
   - Суть: P&L для малого бизнеса; артефакт — таблица учёта. В конце — v2 «Цифры и метрики».
5. **Уровень 5: Создание УТП** (Навык: 🎯 Магнит клиентов)
   - Суть: формула ценности; артефакт — конструктор УТП.
6. **Уровень 6: Elevator Pitch — 1‑минутное представление** (Навык: 🎯 Магнит клиентов)
   - Суть: структура питча; артефакт — карточка питча.
7. **Уровень 7: Мини‑планирование на неделю (SMART)** (Навык: ⚡ Система действий)
   - Суть: SMART и недельные циклы; артефакт — SMART‑шаблон. В конце — v3 «SMART‑план».
8. **Уровень 8: Блиц‑опрос клиентов** (Навык: 🎯 Магнит клиентов)
   - Суть: быстрые интервью, проверка гипотез; артефакт — гайд вопросов.
9. **Уровень 9: Юридический чек‑лист** (Навык: 💰 Денежный контроль)
   - Суть: базовые юридические требования; артефакт — чек‑лист.
10. **Уровень 10: Моя карта ближайших действий** (Навык: ⚡ Система действий)
    - Суть: интеграция пройденного в план на месяц; артефакт — карта действий. В конце — v4 «Финальная формула».

---

## Этапы достижения
1. Заполнить профиль (уровень 0) — включить персонализацию тренеров.
2. Пройти 10 уровней, последовательно кристаллизуя цель (v1→v4) с помощью Макса и материалов уровней.
3. Пройти 28‑дневный путь к цели (4 спринта), каждую неделю фиксируя артефакты/результаты.
4. Подвести финальные итоги, сравнить прогресс с целевыми метриками и закрепить новые привычки.

---

## Метрики успеха
- Завершение уровней: % пользователей, завершивших 1‑й/3‑й/10‑й уровни.
- Конверсия в Premium после блокировки 4‑го уровня.
- Активность в чате: среднее кол‑во полезных диалогов в неделю.
- Цель: доля пользователей, прошедших v1→v4; доля завершивших 28 дней; частота чек‑инов.
- Навыки: прирост очков по каждому из 5 навыков.

---

## Roadmap (черновик)
- Улучшение RAG: гибридный поиск, реранк, фильтры по метаданным.
- Расширение «памяти» и свёрток чатов; персональные темы‑дайджесты.
- Уведомления, календарные интеграции, экспорт целей в PDF, публикация достижений.
- Новые уровни/навыки и расширение каталога «Базы тренеров».
