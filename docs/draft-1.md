# План внедрения рекомендаций дизайна BizLevel (Design Strategy → Code)

## Принципы
- Безопасность: без ломающих изменений навигации/контрактов; UI под флагами, где риск выше.
- Консистентность: использовать `AppColor/AppSpacing/AppDimensions/AppAnimations/AppTheme`.
- A11y: min touch target ≥48, контраст, Semantics/Focus.
- Производительность: без тяжёлых слоёв/Canvas там, где можно обойтись стилями/градиентами.

---

## Эпик A. Главная (Main Street)
1) Цветовое кодирование карточек разделов
   - Изменения: фон/иконки карточек 5 разделов по типу (Библиотека=синий, Маркетплейс=зеленый, Коворкинг=фиолетовый, Башня=градиент золотой→фиолетовый, Тренеры=премиум).
   - Где: `lib/screens/main_street_screen.dart`, используемые виджеты карточек.
   - Безопасно: только стили/декорации, логику переходов не трогаем.
   - Риски: контраст/оверфлоу на узких экранах → проверить 320–400 px.
   - Критерии: визуально различимые зоны, тесты `street_screen_test` зелёные.

---

## Эпик B. Цель (Goal)
1) Hero-прогресс: круг + «Дней до дедлайна» 
   - Изменения: секция над `GoalCompactCard` или внутри неё, градиент по прогрессу (жёлтый→фиолетовый→зелёный).
   - Где: `lib/screens/goal/widgets/goal_compact_card.dart` (или соседний виджет).
   - Безопасно: вычисления на базе уже доступных полей; при отсутствии данных — скрывать.
   - Риски: переполнения на мобиле → Responsive/ConstrainedBox.
   - Критерии: нет overflow, корректные значения при пустых/частичных данных.

---

## Эпик C. Башня (Tower)
1) Манхэттен‑путь с вертикальным градиентом
   - Изменения: в painter слоёв путей добавить градиент «низ→верх» поверх статусов (не мешая цветам статусов).
   - Где: `lib/screens/tower/tower_tiles.dart` (painter/слои путей).
   - Безопасно: один дополнительный `Paint.shader`, без новых перерисовок вне invalidate.
   - Риски: производительность на слабых устройствах → gated упрощённой кистью.
   - Критерии: FPS без просадок, визуал соответствует макету.

---

## Эпик D. Чат (Leo/Max)
1) Персональность: микроанимация аватара (low‑end‑aware)
   - Изменения: лёгкий float/blink раз в N секунд под флагом low‑end.
   - Где: `lib/screens/leo_dialog_screen.dart` (хедер/аватар), `widgets/common/bizlevel_chat_bubble.dart` (если аватар там).
   - Безопасно: отключение на web/low‑end, без таймеров в каждом build.
   - Риски: отвлекает → минимальная амплитуда, редкая частота.
   - Критерии: не мешает вводу, не влияет на автоскролл/пагинацию.

2) Подсказки: горизонтальная лента + «Ещё…»
   - Изменения: одна строка скролла; раскрытие — bottom sheet c полным списком.
   - Где: `leo_dialog_screen.dart` (chips/подсказки).
   - Безопасно: текущий контракт подсказок сохранён; кнопка «Показать подсказки» при сворачивании.
   - Критерии: не перекрывает клавиатуру, доступность кнопок сохранена.

---

## Эпик E. Чекпоинты L4/L7
1) Единый хедер «диалог Макса»
   - Изменения: шапка карточки с аватаром, бейджем «Чекпоинт L4/L7», фоном `backgroundInfo`.
   - Где: `lib/screens/checkpoints/checkpoint_l4_screen.dart`, `checkpoint_l7_screen.dart`.
   - Безопасно: только UI обёртка; сохранение/чат не трогаем.
   - Критерии: единый вид, нет overflow.

---

## Эпик F. Профиль
1) «Витрина достижений»
   - Изменения: горизонтальная лента `AchievementBadge` (3–6 шт.) + «Показать все».
   - Где: `lib/screens/profile_screen.dart`.
   - Безопасно: отображение по имеющимся событиям/скиллам, без новых API.
   - Критерии: нет подвисаний при скролле.

---

## Эпик G. Артефакты
1) Tilt/hover и индикатор «Новый»
   - Изменения: лёгкий 3D‑наклон при hover/tap, точка «New» до первого открытия.
   - Где: `lib/screens/level_detail_screen.dart` (превью) и экран `/artifacts`.
   - Безопасно: без внешних зависимостей, выключение на low‑end.
   - Критерии: без конфликтов с жестами просмотра.

---

## Эпик H. Library
1) Fade‑in для списков + единый Empty/Error
   - Изменения: анимация появления элементов; `BizLevelEmpty/Error` с иконкой, без SnackBar по умолчанию.
   - Где: `lib/screens/library/*.dart`.
   - Безопасно: анимации через `AnimatedSwitcher/Opacity`, без пакетов.
   - Критерии: нет мерцаний/скачков, семантика сохранена.

---

## Эпик I. Формы
1) Единый InputDecorationTheme
   - Изменения: заменить локальные `InputDecoration` на токенизированные; убрать инлайны цветов/радиусов.
   - Где: формы: чекпоинты L1/L4/L7, профиль, goal.
   - Безопасно: поведение/валидации без изменений.
   - Критерии: нет regress в тестах ввода, фокус‑бордеры из темы.

---

## Эпик J. Dark mode
1) Тумблер темы в Настройках
   - Изменения: переключатель Light/Dark/System; подключить `AppTheme.dark()`.
   - Где: экран настроек профиля.
   - Безопасно: хранение prefs локально; дефолт — Light.
   - Критерии: контрасты/иконки читаемы, инпуты получают `fillColor: surfaceDark`.

---

## Эпик K. A11y
1) Фокус‑индикаторы и TabOrder
   - Изменения: для основных кнопок/чипов явные `focusColor/shape` (бордер `borderStrong`), логичный порядок Tab.
   - Где: Main/Goal/Tower/Chat/Library.
   - Безопасно: без влияния на мышь/тач, только клавиатура.
   - Критерии: проходимость по клавиатуре, видимый фокус.

---

## Эпик L. Loading
1) Skeleton‑плейсхолдеры
   - Изменения: карточные скелетоны (без shimmer) для списков/секций.
   - Где: Library, Levels, Goal (журнал), Profile.
   - Безопасно: статичные плейсхолдеры на токенах.
   - Критерии: меньше «пустых экранов», без лишних перерисовок.

---

## Дорожная карта внедрения (итерации)
- Итер. 1 (быстрые победы): A1, B1, H1, I1.
- Итер. 2: D2, E1, F1.
- Итер. 3: C1 (градиент пути), G1.
- Итер. 4: J1, K1, L1.

## Ревью и тесты
- UI‑скрины до/после на 320/375/414/768/1024.
- Widget‑smoke обновить: street/goal/tower/library/profile.
- Прогон accessibility checklist (фокус/контраст/размеры).

## Риски и откаты
- Производительность painter в башне → фича‑флаг на градиент.
- Мини‑тур/микроанимации → зафлагировать и отключать на low‑end.
- Dark mode → зафичефлагить до полного покрытия экранов.
